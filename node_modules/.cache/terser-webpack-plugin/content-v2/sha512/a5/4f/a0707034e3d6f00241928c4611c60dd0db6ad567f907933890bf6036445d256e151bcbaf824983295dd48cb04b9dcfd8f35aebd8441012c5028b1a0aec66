{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{203:function(a,t,s){a.exports=s.p+\"assets/img/nacos-config-add.630f2390.jpg\"},204:function(a,t,s){a.exports=s.p+\"assets/img/nacos-config-demo1.4eb5d36f.jpg\"},205:function(a,t,s){a.exports=s.p+\"assets/img/nacos-config-history.d53fec37.jpg\"},206:function(a,t,s){a.exports=s.p+\"assets/img/nacos-config-refresh.c124ae4b.jpg\"},207:function(a,t,s){a.exports=s.p+\"assets/img/log1.4b3d171e.jpg\"},208:function(a,t,s){a.exports=s.p+\"assets/img/log-api.1dcb8a75.jpg\"},209:function(a,t,s){a.exports=s.p+\"assets/img/log-default-group.fbdbf1ac.jpg\"},240:function(a,t,s){\"use strict\";s.r(t);var n=s(0),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,n=a._self._c||t;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"nacos基础spring-cloud实现配置中心\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nacos基础spring-cloud实现配置中心\"}},[a._v(\"#\")]),a._v(\" Nacos基础spring cloud实现配置中心\")]),a._v(\" \"),n(\"h2\",{attrs:{id:\"nacos入门\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nacos入门\"}},[a._v(\"#\")]),a._v(\" Nacos入门\")]),a._v(\" \"),n(\"p\",[a._v(\"新建spring boot项目，项目名称\"),n(\"code\",[a._v(\"nacos-config\")]),a._v(\"，并添加一个\"),n(\"code\",[a._v(\"User\")]),a._v(\"对象，包含\"),n(\"code\",[a._v(\"name\")]),a._v(\"和\"),n(\"code\",[a._v(\"age\")]),a._v(\"属性。\")]),a._v(\" \"),n(\"h3\",{attrs:{id:\"添加maven依赖\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#添加maven依赖\"}},[a._v(\"#\")]),a._v(\" 添加maven依赖\")]),a._v(\" \"),n(\"p\",[a._v(\"pom添加maven管理\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-maven extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[a._v(\"<dependencyManagement>\\n    <dependencies>\\n        <dependency>\\n            <groupId>org.springframework.cloud</groupId>\\n            <artifactId>spring-cloud-alibaba-dependencies</artifactId>\\n            <version>0.2.1.RELEASE</version>\\n            <type>pom</type>\\n            <scope>import</scope>\\n        </dependency>\\n    </dependencies>\\n</dependencyManagement>\\n\")])])]),n(\"p\",[a._v(\"然后添加\"),n(\"code\",[a._v(\"nacos-config\")]),a._v(\"maven依赖。\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-maven extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[a._v(\"<dependency>\\n    <groupId>org.springframework.cloud</groupId>\\n    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>\\n</dependency>\\n\")])])]),n(\"p\",[a._v(\"或者直接添加\"),n(\"code\",[a._v(\"nacos-config\")]),a._v(\"依赖\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-maven extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[a._v(\"<dependency>\\n    <groupId>org.springframework.cloud</groupId>\\n    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>\\n    <version>0.2.1.RELEASE</version>\\n</dependency>\\n\")])])]),n(\"h3\",{attrs:{id:\"维护配置信息\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#维护配置信息\"}},[a._v(\"#\")]),a._v(\" 维护配置信息\")]),a._v(\" \"),n(\"p\",[a._v(\"在nacos管理界面中添加如下配置：\\n\"),n(\"img\",{attrs:{src:s(72),alt:\"\"}})]),a._v(\" \"),n(\"h3\",{attrs:{id:\"配置相关信息\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置相关信息\"}},[a._v(\"#\")]),a._v(\" 配置相关信息\")]),a._v(\" \"),n(\"p\",[n(\"em\",[n(\"strong\",[a._v(\"注意\")])]),a._v(\"：配置文件应为：\"),n(\"code\",[a._v(\"bootstrap\")]),a._v(\",而不能为\"),n(\"code\",[a._v(\"application\")]),a._v(\"。因为spring boot(spring cloud)首先加载的配置文件为\"),n(\"code\",[a._v(\"bootstrap\")]),a._v(\"。\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-yaml extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"spring\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"cloud\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"nacos\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"config\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"server-addr\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" 127.0.0.1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"8848\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"file-extension\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" your configuration format\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"group\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" yourgourpname\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"prefix\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" yourdataidname \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#此处名称应与在nacos创建的配置文件名称一致，如不维护默认取项目名称\")]),a._v(\"\\n\")])])]),n(\"h3\",{attrs:{id:\"新建配置信息\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#新建配置信息\"}},[a._v(\"#\")]),a._v(\" 新建配置信息\")]),a._v(\" \"),n(\"p\",[a._v(\"在\"),n(\"code\",[a._v(\"Nacos\")]),a._v(\"管理界面中打开\"),n(\"code\",[a._v(\"配置列表\")]),a._v(\"，新建一个配置文件。\\n\"),n(\"img\",{attrs:{src:s(203),alt:\"\"}}),a._v(\" \"),n(\"em\",[n(\"strong\",[a._v(\"注意\")])]),a._v(\"：\")]),a._v(\" \"),n(\"ul\",[n(\"li\",[a._v(\"Nacos暂只支持\"),n(\"code\",[a._v(\"yaml\")]),a._v(\"和\"),n(\"code\",[a._v(\"properties\")]),a._v(\"格式。\")]),a._v(\" \"),n(\"li\",[a._v(\"Data ID为配置文件名，group为配置文件组。\")])]),a._v(\" \"),n(\"h3\",{attrs:{id:\"读取配置文件\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#读取配置文件\"}},[a._v(\"#\")]),a._v(\" 读取配置文件\")]),a._v(\" \"),n(\"p\",[a._v(\"新建\"),n(\"code\",[a._v(\"UserController\")]),a._v(\"，通过\"),n(\"code\",[a._v(\"@Value\")]),a._v(\"注解获取配置信息。\")]),a._v(\" \"),n(\"p\",[n(\"strong\",[a._v(\"注意\")]),a._v(\" 通过\"),n(\"code\",[a._v(\"@NacosPropertySource\")]),a._v(\"和\"),n(\"code\",[a._v(\"@NacosValue\")]),a._v(\"也可实现获取配置信息，如果采用了\"),n(\"code\",[a._v(\"Spring Cloud\")]),a._v(\"，为了与其他配置中心兼容，推荐采用\"),n(\"code\",[a._v(\"@Value\")]),a._v(\"注解。\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-java extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[a._v(\"    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@Value\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"${user.name}\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"private\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"String\")]),a._v(\" name\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@Value\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"${user.age}\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"private\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"Integer\")]),a._v(\" age\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@GetMapping\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"user\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"public\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"User\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"getUser\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"{\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"User\")]),a._v(\" user \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"=\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"new\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"User\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n        user\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"setName\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"name\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n        user\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"setAge\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),a._v(\"age\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"return\")]),a._v(\" user\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"}\")]),a._v(\"\\n\")])])]),n(\"p\",[a._v(\"通过api查询配置结果:\\n\"),n(\"img\",{attrs:{src:s(204),alt:\"\"}})]),a._v(\" \"),n(\"h2\",{attrs:{id:\"nacos基本概念\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nacos基本概念\"}},[a._v(\"#\")]),a._v(\" Nacos基本概念\")]),a._v(\" \"),n(\"h3\",{attrs:{id:\"命名空间、分组、dataid\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#命名空间、分组、dataid\"}},[a._v(\"#\")]),a._v(\" 命名空间、分组、dataid\")]),a._v(\" \"),n(\"p\",[a._v(\"在\"),n(\"code\",[a._v(\"nacos-config\")]),a._v(\"中有三个非常重要的概念：namespace、group及dataid。\\n\"),n(\"a\",{attrs:{href:\"../../img/nacos-config-manage.jpg\"}})]),a._v(\" \"),n(\"ul\",[n(\"li\",[n(\"p\",[a._v(\"dataid：配置文件名称，同一\"),n(\"code\",[a._v(\"group\")]),a._v(\"下必须唯一。匹配规则为：\"),n(\"code\",[a._v(\"${spring.cloud.nacos.config.prefix}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension}\")])])]),a._v(\" \"),n(\"li\",[n(\"p\",[a._v(\"group: 配置组，不同\"),n(\"code\",[a._v(\"group\")]),a._v(\"中可包含相同名称的\"),n(\"code\",[a._v(\"dataid\")]),a._v(\"使用上比较灵活，可以按系统分组，也可按配置类型分组。\")])]),a._v(\" \"),n(\"li\",[n(\"p\",[a._v(\"namespace：命名空间，具有数据隔离性，可以按不同租户进行隔离；也可按不同环境进行隔离，如：开发环境、测试环境、生产环境。\")])])]),a._v(\" \"),n(\"h3\",{attrs:{id:\"版本管理\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#版本管理\"}},[a._v(\"#\")]),a._v(\" 版本管理\")]),a._v(\" \"),n(\"p\",[a._v(\"打开\"),n(\"code\",[a._v(\"Nacos\")]),a._v(\"管理界面\"),n(\"code\",[a._v(\"历史版本\")]),a._v(\"菜单：输入\"),n(\"code\",[a._v(\"dataid\")]),a._v(\"和\"),n(\"code\",[a._v(\"group\")]),a._v(\"信息后可搜索最近30天更改记录。也可对指定配置信息进行回滚操作。\\n\"),n(\"img\",{attrs:{src:s(205),alt:\"\"}})]),a._v(\" \"),n(\"h2\",{attrs:{id:\"配置管理\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置管理\"}},[a._v(\"#\")]),a._v(\" 配置管理\")]),a._v(\" \"),n(\"h3\",{attrs:{id:\"配置动态刷新\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置动态刷新\"}},[a._v(\"#\")]),a._v(\" 配置动态刷新\")]),a._v(\" \"),n(\"p\",[a._v(\"在需要动态刷新的类上加上注解\"),n(\"code\",[a._v(\"@RefreshScope\")]),a._v(\"。\\n此处注意，要保证\"),n(\"code\",[a._v(\"spring boot\")]),a._v(\"版本与\"),n(\"code\",[a._v(\"spring cloud\")]),a._v(\"版本想匹配；\"),n(\"code\",[a._v(\"spring cloud alibaba\")]),a._v(\"版本与\"),n(\"code\",[a._v(\"spring boot\")]),a._v(\"版本匹配。否则可能无法动态刷新配置内容。\")]),a._v(\" \"),n(\"p\",[a._v(\"| \"),n(\"em\",[n(\"strong\",[a._v(\"tips\")])]),a._v(\"：如果未动态刷新配置内容，可引入\"),n(\"code\",[a._v(\"spring boot\")]),a._v(\"版本对应的\"),n(\"code\",[a._v(\"spring cloud\")]),a._v(\"版本。\")]),a._v(\" \"),n(\"p\",[a._v(\"然后在\"),n(\"code\",[a._v(\"Nacos\")]),a._v(\"管理界面更改配置内容后并发布。\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-yaml extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"user\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"name\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" 张三\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"age\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"23\")]),a._v(\"\\n\")])])]),n(\"p\",[a._v(\"此时可重新调用api获取\"),n(\"code\",[a._v(\"user\")]),a._v(\"信息：\\n\"),n(\"img\",{attrs:{src:s(206),alt:\"\"}})]),a._v(\" \"),n(\"h3\",{attrs:{id:\"多文件加载配置\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#多文件加载配置\"}},[a._v(\"#\")]),a._v(\" 多文件加载配置\")]),a._v(\" \"),n(\"p\",[a._v(\"在项目实施微服务化后，我们可能需要不同服务的配置内容抽离出公共部分，实现统一管理。\")]),a._v(\" \"),n(\"p\",[a._v(\"我们在\"),n(\"code\",[a._v(\"Nacos\")]),a._v(\"管理界面增加一个日志配置文件。\\n\"),n(\"img\",{attrs:{src:s(207),alt:\"\"}})]),a._v(\" \"),n(\"p\",[a._v(\"修改\"),n(\"code\",[a._v(\"bootstrap.yml\")]),a._v(\"配置内容：\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-yml extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yml\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"spring\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"application\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"name\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" nacos\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"cloud\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"nacos\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"config\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"server-addr\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" 127.0.0.1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"8848\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"prefix\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" nacos\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"file-extension\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" yaml\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"group\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" github\\n\\n        ext\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"]\")]),a._v(\".dataId\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" log1.yaml\\n        ext\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"]\")]),a._v(\".group\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" github\\n        ext\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"[\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"]\")]),a._v(\".refresh\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token boolean important\"}},[a._v(\"true\")]),a._v(\"\\n\")])])]),n(\"p\",[a._v(\"添加\"),n(\"code\",[a._v(\"LogController\")])]),a._v(\" \"),n(\"div\",{staticClass:\"language-java extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@RestController\")]),a._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@RefreshScope\")]),a._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"public\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"class\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"LogController\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"{\")]),a._v(\"\\n\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@Value\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"${log.level}\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"private\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"String\")]),a._v(\" logLevel\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@Value\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"${log.path}\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"private\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"String\")]),a._v(\" logPath\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[a._v(\"@GetMapping\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"log\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"public\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[a._v(\"String\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"getLogLevel\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"{\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[a._v(\"return\")]),a._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\"level:\"')]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"+\")]),a._v(\" logLevel\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"+\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v('\";path:\"')]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"+\")]),a._v(\"logPath\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\";\")]),a._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"}\")]),a._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"}\")]),a._v(\"\\n\")])])]),n(\"p\",[a._v(\"浏览结果:\\n\"),n(\"img\",{attrs:{src:s(208),alt:\"\"}})]),a._v(\" \"),n(\"h3\",{attrs:{id:\"共享配置文件\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#共享配置文件\"}},[a._v(\"#\")]),a._v(\" 共享配置文件\")]),a._v(\" \"),n(\"p\",[a._v(\"下面以\"),n(\"code\",[a._v(\"shared-dataids\")]),a._v(\"实现配置共享配置文件。\")]),a._v(\" \"),n(\"p\",[a._v(\"1、将\"),n(\"code\",[a._v(\"ext-config\")]),a._v(\"配置方式注释。添加\"),n(\"code\",[a._v(\"shared-dataids\")]),a._v(\"和\\n\"),n(\"code\",[a._v(\"refreshable-dataids\")]),a._v(\"。\")]),a._v(\" \"),n(\"div\",{staticClass:\"language-yml extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-yml\"}},[n(\"code\",[a._v(\"    \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"nacos\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"config\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"server-addr\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" 127.0.0.1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"8848\")]),a._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"prefix\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" nacos\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"-\")]),a._v(\"config\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"file-extension\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" yaml\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"group\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" github\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"shared-dataids\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" log.yaml\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"refreshable-dataids\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" log.yaml\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#        ext-config[0].dataId: log1.yaml\")]),a._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#        ext-config[0].group: github\")]),a._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[a._v(\"#        ext-config[0].refresh: true\")]),a._v(\"\\n\")])])]),n(\"p\",[a._v(\"2、新建log.yml，配置文件，注意\"),n(\"code\",[a._v(\"gourp\")]),a._v(\"为默认值。\")]),a._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:s(209),alt:\"\"}})]),a._v(\" \"),n(\"p\",[a._v(\"再次调用api查看结果，发现结果一致。\")]),a._v(\" \"),n(\"h2\",{attrs:{id:\"总结\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#总结\"}},[a._v(\"#\")]),a._v(\" 总结\")]),a._v(\" \"),n(\"ul\",[n(\"li\",[a._v(\"nacos config读取配置主要有以下三种方式：\")])]),a._v(\" \"),n(\"p\",[a._v(\"A：通过\"),n(\"code\",[a._v(\"spring.cloud.nacos.config.shared-dataids\")]),a._v(\"方式；\")]),a._v(\" \"),n(\"p\",[a._v(\"B：通过\"),n(\"code\",[a._v(\"spring.cloud.nacos.config.ext-config\")]),a._v(\"方式\")]),a._v(\" \"),n(\"p\",[a._v(\"C：通过\"),n(\"code\",[a._v(\"spring.cloud.nacos.config.prefix\")]),a._v(\"方式\")]),a._v(\" \"),n(\"p\",[a._v(\"如果同时采用多个方式获取配置内容，配置文件包含相同key的话，优先级为：C->B->A。\")]),a._v(\" \"),n(\"h2\",{attrs:{id:\"参考\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考\"}},[a._v(\"#\")]),a._v(\" 参考\")]),a._v(\" \"),n(\"p\",[n(\"a\",{attrs:{href:\"https://nacos.io/zh-cn/blog/index.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a._v(\"Nacos博客\"),n(\"OutboundLink\")],1)])])}),[],!1,null,null,null);t.default=e.exports},72:function(a,t,s){a.exports=s.p+\"assets/img/nacos-bin.bf3e989a.jpg\"}}]);","extractedComments":[]}